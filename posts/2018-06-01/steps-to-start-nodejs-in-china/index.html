<!DOCTYPE html><html lang="cn" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="NodeJS起步两三事" /><meta property="og:locale" content="cn" /><meta name="description" content="主要是为了备忘，开始接触NodeJS有一段时间，断断续续，年纪也大了时间一长容易忘事情，汗。" /><meta property="og:description" content="主要是为了备忘，开始接触NodeJS有一段时间，断断续续，年纪也大了时间一长容易忘事情，汗。" /><link rel="canonical" href="https://tobyqin.cn/posts/2018-06-01/steps-to-start-nodejs-in-china/" /><meta property="og:url" content="https://tobyqin.cn/posts/2018-06-01/steps-to-start-nodejs-in-china/" /><meta property="og:site_name" content="Practice" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-06-01T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="NodeJS起步两三事" /><meta name="twitter:site" content="@toby_qin" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2018-06-01T00:00:00+08:00","datePublished":"2018-06-01T00:00:00+08:00","description":"主要是为了备忘，开始接触NodeJS有一段时间，断断续续，年纪也大了时间一长容易忘事情，汗。","headline":"NodeJS起步两三事","mainEntityOfPage":{"@type":"WebPage","@id":"https://tobyqin.cn/posts/2018-06-01/steps-to-start-nodejs-in-china/"},"url":"https://tobyqin.cn/posts/2018-06-01/steps-to-start-nodejs-in-china/"}</script><title>NodeJS起步两三事 | Practice</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Practice"><meta name="application-name" content="Practice"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://image.tobyqin.cn/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Practice</a></div><div class="site-subtitle font-italic">makes perfect</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span></span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/notes/" class="nav-link"> <i class="fa-fw fas fa-book-open ml-xl-3 mr-xl-3 unloaded"></i> <span>NOTES</span> </a><li class="nav-item"> <a href="/md/" class="nav-link"> <i class="fa-fw fas fa-book-open ml-xl-3 mr-xl-3 unloaded"></i> <span>EDITOR</span> </a><li class="nav-item"> <a href="/hiring/" class="nav-link"> <i class="fa-fw fas fa-book-open ml-xl-3 mr-xl-3 unloaded"></i> <span>HIRING</span> </a><li class="nav-item"> <a href="/links/" class="nav-link"> <i class="fa-fw fas fa-book-open ml-xl-3 mr-xl-3 unloaded"></i> <span>LINKS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT AUTHOR</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tobyqin" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['hello','tobyqin.cn'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/toby-qin-2684a630/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> </a> </span> <span>NodeJS起步两三事</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="..."> </span> <span id="search-cancel" ></span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>NodeJS起步两三事</h1><div class="post-meta text-muted"> <span> <em class="" data-ts="1527782400" data-df="DD/MM/YYYY" data-toggle="tooltip" data-placement="bottom"> 01/06/2018 </em> </span><div class="d-flex justify-content-between"> <span> <em> <a href="https://github.com/tobyqin">Toby Qin</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2097 "> <em>11 </em> </span></div></div></div><div class="post-content"><p>主要是为了备忘，开始接触NodeJS有一段时间，断断续续，年纪也大了时间一长容易忘事情，汗。</p><h2 id="安装node"><span class="mr-2">安装Node</span><a href="#安装node" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>直接到<a href="https://nodejs.org/en/download/">官网下载</a>LTS版本安装即可，没必要追新功能用最新版。安装Node基本没什么坑，记得加到PATH就好。</p><p>Windows双击安装，macOS推荐使用brew安装，完成后在命令行里测试一下。</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>node <span class="nt">-v</span>
</pre></table></code></div></div><p>后期如果没有啥breaking的API改动基本也不用升级。</p><h2 id="必要的配置"><span class="mr-2">必要的配置</span><a href="#必要的配置" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>NodeJS的包管理器<code class="language-plaintext highlighter-rouge">npm</code>，如果在墙内及有可能在使用过程中很不稳定，一般推荐使用国内的镜像源，目前最知名的也就是淘宝家的了。</p><blockquote><p>https://npm.taobao.org/</p></blockquote><h3 id="npmrc"><span class="mr-2">.npmrc</span><a href="#npmrc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>你可以通过修改<code class="language-plaintext highlighter-rouge">~/.npmrc</code>来设置默认的包源:</p><div class="language-ini highlighter-rouge"><div class="code-header"> <span data-label-text="Ini"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="py">registry</span><span class="p">=</span><span class="s">https://registry.npm.taobao.org/</span>
</pre></table></code></div></div><h3 id="cnpm"><span class="mr-2">cnpm</span><a href="#cnpm" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>你也可以安装 <code class="language-plaintext highlighter-rouge">cnpm</code> 来代替 <code class="language-plaintext highlighter-rouge">npm</code> ：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>npm install cnpm -g
</pre></table></code></div></div><p>之后的大部分<code class="language-plaintext highlighter-rouge">npm</code> 都可以直接用 <code class="language-plaintext highlighter-rouge">cnpm</code> 代替（发布相关的除外）：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cnpm install &lt;package&gt;
</pre></table></code></div></div><h3 id="nrm"><span class="mr-2">nrm</span><a href="#nrm" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>其实我还推荐你了解另外一种切换源的方式 <code class="language-plaintext highlighter-rouge">nrm</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmp install nrm -g
</pre></table></code></div></div><p>使用方法如下，超级简单：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>$ nrm ls

* npm ---- https://registry.npmjs.org/
  cnpm --- http://r.cnpmjs.org/
  taobao - https://registry.npm.taobao.org/
  nj ----- https://registry.nodejitsu.com/
  rednpm - http://registry.mirror.cqupt.edu.cn/
  npmMirror  https://skimdb.npmjs.com/registry/
  edunpm - http://registry.enpmjs.org/
  
$ nrm use taobao

  Registry has been set to: https://registry.npm.taobao.org/

</pre></table></code></div></div><p>使用 <code class="language-plaintext highlighter-rouge">nrm ls</code> 列出可以切换的源，然后<code class="language-plaintext highlighter-rouge">nrm use &lt;name&gt;</code> 瞬间切换，爽！</p><h3 id="proxy"><span class="mr-2">proxy</span><a href="#proxy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>镜像源毕竟是copy的，同步状态有可能你不甚满意，最近taobao的源可能还有以下错误：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>npm ERR! registry error parsing json
</pre></table></code></div></div><p>作为一个资深码农你也许有一个本地代理（SS懂？）让你无障碍访问国际互联网，那么你可以这么做：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>npm config set proxy http://server:port
npm config set https-proxy http://server:port
</pre></table></code></div></div><p>配置好 <code class="language-plaintext highlighter-rouge">npm</code> 的代理后你又可以开心地玩耍了。</p><h2 id="node入门须知"><span class="mr-2">Node入门须知</span><a href="#node入门须知" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>三分钟入门NodeJS，如果你已经有其他语言的编程经验，是可以的。</p><p>NodeJS的核心可执行程序<code class="language-plaintext highlighter-rouge">node[.exe]</code>你可以简单理解成代码解释器，类似于Java的虚拟机，C#的.net Framework，Python里的<code class="language-plaintext highlighter-rouge">python[.exe]</code>，作用是把你的代码翻译成计算机行为。</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>node hello.js
</pre></table></code></div></div><p>以上就是运行NodeJS代码的不二法则。</p><h3 id="项目启动"><span class="mr-2">项目启动</span><a href="#项目启动" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>很多知名框架都会提供所谓的脚手架命令，但是对于萌新玩家，我是不建议直接去使用脚手架的，这些脚手架做出来的目录结构对于萌新玩家来说是懵逼的，虽然有可能都是最佳实践的结果，但没有1，2，3步骤和手拉手，萌新也许直接退出游戏了。</p><p>新手真正的入门法则还是踏踏实实按照各种教程一步一步走，如果教程不好就换，没学会走路就想跑是不可能的。一般项目是这样开始的：</p><ol><li>明确项目需求（略）<li>创建项目目录<li>初始化项目信息<li>安装必要的依赖<li>模块划分，编码<li>系统集成，测试<li>项目发布，维护升级</ol><p>这个流程用NodeJS来实践大致是这样的：</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="c"># create project </span>
<span class="nb">mkdir</span> <span class="o">[</span>project-name]
<span class="nb">cd</span> <span class="o">[</span>project-name]

<span class="c"># init project</span>
npm init
...

<span class="c"># install dependencies</span>
npm <span class="nb">install</span> &lt;package...&gt;

<span class="c"># install dev dependencies</span>
npm <span class="nb">install</span> &lt;package...&gt; <span class="nt">-D</span>

<span class="c"># coding</span>
...

<span class="c"># run and test</span>
npm run build
npm run start
npm run <span class="nb">test
</span>npm run stop

<span class="c"># publish project</span>
npm publish <span class="nb">.</span>
</pre></table></code></div></div><p>前面一节全都是在介绍<code class="language-plaintext highlighter-rouge">npm</code>，通过这个例子你应该明白它在NodeJS中的重要性了吧，所以让你的<code class="language-plaintext highlighter-rouge">npm</code>好用意义非凡。</p><p>例子中安装了两次依赖可能你有点困惑，可以这样理解，第一次依赖是项目运行时必要的依赖<code class="language-plaintext highlighter-rouge">--save-prod</code>，在发布时必须安装的；第二次依赖主要是用于开发或者测试的<code class="language-plaintext highlighter-rouge">--save-dev</code>，比如某些debug包或者test框架，方便开发才需要的包，在项目部署时没必要安装。其实还可能安装第三种依赖<code class="language-plaintext highlighter-rouge">--save-optional</code>，比如是用来做数据分析或者别的enhancement的，目前Node支持区分对待这三类依赖包。</p><h3 id="语法演示"><span class="mr-2">语法演示</span><a href="#语法演示" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>NodeJS里的JS就是JavaScript，属于动态语言，命名规则类似Java，但是语法更接近各种动态语言，比如Python或者Ruby。上手不难，了解一下标准库和数据基本类型，在IDE的加持下你就可以开始写代码了。</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c1">// index.js 项目的入口文件</span>

<span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">fs</span><span class="dl">'</span><span class="p">);</span>  <span class="c1">// 导入标准库模块</span>
<span class="kd">var</span> <span class="nx">_</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">lodash</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 导入已安装的包</span>

<span class="kd">var</span> <span class="nx">m</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">./hello</span><span class="dl">'</span><span class="p">);</span> <span class="err"> </span><span class="c1">// 导入同目录下的模块</span>
<span class="k">import</span> <span class="nx">hello</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./test</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// 导入模块的部分对象</span>

<span class="nx">m</span><span class="p">.</span><span class="nx">say</span><span class="p">(</span><span class="dl">'</span><span class="s1">yo..</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 调用模块方法</span>
<span class="nx">hello</span><span class="p">(</span><span class="dl">'</span><span class="s1">toby</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">fs</span><span class="p">.</span><span class="nx">copyFileSync</span><span class="p">(</span><span class="nx">src</span><span class="p">,</span><span class="nx">dst</span><span class="p">)</span> <span class="c1">// 调用标准库方法</span>
</pre></table></code></div></div><p>模块的编写范例：</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c1">// hello.js</span>

<span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">hello world!</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// 模块的全局变量不会被导出</span>

<span class="kd">function</span> <span class="nx">say</span><span class="p">(</span><span class="nx">word</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="dl">'</span><span class="s1">say </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">word</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">hello</span><span class="p">(</span><span class="nx">word</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello, </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">word</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 导出就是对 module.exports 进行赋值</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">say</span><span class="p">:</span> <span class="nx">say</span><span class="p">,</span>
    <span class="na">hello</span><span class="p">:</span> <span class="nx">hello</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="包管理小贴士"><span class="mr-2">包管理小贴士</span><a href="#包管理小贴士" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>对于<code class="language-plaintext highlighter-rouge">npm</code>包的安装的位置我们来了解一下，简单来说就是这个包所作用的范围。如果安装包不带<code class="language-plaintext highlighter-rouge">-g</code>参数那么默认就是安装在当前目录。</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>npm install &lt;package&gt;
# =&gt; will install to ./node_modules
</pre></table></code></div></div><p>这个包也就只有在当前目录（项目）里可用，这样方便做到环境隔离，不同项目可以用同样包的不同版本等等。</p><h3 id="-g"><span class="mr-2">-g</span><a href="#-g" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>如果安装过程中带了<code class="language-plaintext highlighter-rouge">-g</code>参数那么就意味这个包是全局（global）安装的，在系统的任何位置都是可用的。</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>npm install &lt;package&gt; -g
# =&gt; will install to /usr/local/lib/node_modules
# =&gt; or %AppData%\npm\node_modules
</pre></table></code></div></div><p>一般的包安装都是不用带<code class="language-plaintext highlighter-rouge">-g</code>的，除了一些工具类的包，例如第一节介绍那些，这样系统干净一些，也可以避免全局包污染项目导致各种灵异事件。</p><h3 id="depth"><span class="mr-2">–depth</span><a href="#depth" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>如果要查看安装了哪些global包可以用这个命令：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>npm list -g --depth=0
</pre></table></code></div></div><p>如果不加<code class="language-plaintext highlighter-rouge">--depth</code>，哎我去真没法看，也不知设计这个<code class="language-plaintext highlighter-rouge">list</code>的人为啥不默认带上这个参数，脑子被门夹了。为了方便你可以配上以下两个alias。</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>alias ng="npm list -g --depth=0 2&gt;/dev/null"
alias nl="npm list --depth=0 2&gt;/dev/null"
</pre></table></code></div></div><h3 id="ncu"><span class="mr-2">ncu</span><a href="#ncu" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>使用NodeJS就是要面对各种各样的包，有些包升级很勤快，你也想升级怎么办呢？哪些是outdated哪些不是，<code class="language-plaintext highlighter-rouge">npm</code>的升级命令真的很难用（记）哎。我推荐你了解一下<code class="language-plaintext highlighter-rouge">npm-check-updates</code>：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>npm install npm-check-updates -g
</pre></table></code></div></div><p>这么好用的东西当然要全局安装啦，用法很简单，检查当前项目所有包的更新状态：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>$ cd my-project
$ ncu
Using /Users/tobyqin/src/blog/package.json
[..................] | :
The following dependencies are satisfied by their declared version range, but the installed versions are behind. You can install the latest versions without modifying your package file by using npm update. If you want to update the dependencies in your package file anyway, run ncu -a.

 hexo                   ^3.5.0  →  ^3.7.1
 hexo-generator-search  ^2.1.1  →  ^2.2.5
 hexo-server            ^0.3.1  →  ^0.3.2
</pre></table></code></div></div><p>使用 <code class="language-plaintext highlighter-rouge">ncu -a</code>就可以一键更新项目里的所有包，当然它也提供了一些过滤参数，你可以<a href="https://www.npmjs.com/package/npm-check-updates">查阅文档</a>。如果要看全局的包有没有可以更新的，试试<code class="language-plaintext highlighter-rouge">ncu -g</code>，非常方便。</p><p>有一点要注意，虽然命令是<code class="language-plaintext highlighter-rouge">ncu</code>但是包名不是，因为<code class="language-plaintext highlighter-rouge">ncu</code>的包名已经被一个天气预报的包占用了，无语。</p><h2 id="总结"><span class="mr-2">总结</span><a href="#总结" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>现在写NodeJS项目已经很容易了，JS经过了两三年的野蛮生长，诞生了成千上万个包（框架），其中不乏精品。</p><p>作为搬砖的码农，经过一顿<code class="language-plaintext highlighter-rouge">npm install</code>操作就可以做出一个不错的demo，你还犹豫什么，赶快上车吧！</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/tech/'>Tech</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/nodejs/" class="post-tag no-text-decoration" >nodejs</a> <a href="/tags/mirror/" class="post-tag no-text-decoration" >mirror</a> <a href="/tags/proxy/" class="post-tag no-text-decoration" >proxy</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"></div><div class="share-wrapper"> <span class="share-label text-muted mr-1"></span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=NodeJS起步两三事 - Practice&url=https%3A%2F%2Ftobyqin.cn%2Fposts%2F2018-06-01%2Fsteps-to-start-nodejs-in-china%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=NodeJS起步两三事 - Practice&u=https%3A%2F%2Ftobyqin.cn%2Fposts%2F2018-06-01%2Fsteps-to-start-nodejs-in-china%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ftobyqin.cn%2Fposts%2F2018-06-01%2Fsteps-to-start-nodejs-in-china%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="" data-title-succeed=""> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading"></div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/2023-01-28/devops-survey-2022/">软件研发体验调查报告 2022</a><li><a href="/posts/2022-12-28/goodbye-2022/">2022年，再见</a><li><a href="/posts/2019-06-25/various-schemes-for-forwarding-short-messages/">转发短信的各种方案</a><li><a href="/posts/2022-09-04/delegating/">如何有效授权</a><li><a href="/posts/2022-07-26/eat-the-frog/">吃掉那只青蛙</a></ul></div><div id="access-tags"><div class="panel-heading"></div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/tips/">tips</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/book/">book</a> <a class="post-tag" href="/tags/shell/">shell</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/life/">Life</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/flask/">flask</a> <a class="post-tag" href="/tags/python/">Python</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2"></div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip></h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/2020-02-15/using-yarn-in-github-actions/"><div class="card-body"> <em class="small" data-ts="1581696000" data-df="DD/MM/YYYY" > 15/02/2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>在Github Actions中使用Yarn</h3><div class="text-muted small"><p> Yarn 的呼声时不时比 npm 大，在 Github Actions 里怎么使用 Yarn 呢？ 用 npm 的示例 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 name: Node CI on: [push] jobs: build: runs-on: ubuntu-latest ...</p></div></div></a></div><div class="card"> <a href="/posts/2019-11-23/jenkin-on-mac/"><div class="card-body"> <em class="small" data-ts="1574438400" data-df="DD/MM/YYYY" > 23/11/2019 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>在Mac上部署Jenkins</h3><div class="text-muted small"><p> Jenkins还是我最喜欢的CICD工具。 安装 Jenkins 官网目前推荐的方式是docker运行Jenkins，只需要一条命令就可以搞定。docker是很好用，不过也会有一些不方便的地方： 不能完全访问本地磁盘，需要挂载后才可以，而挂载某个目录还需要提前在docker客户端注册，有点绕。 不能访问本地代理，大家都知道我们的网络条件不是很好，可能会自建代理，docke...</p></div></div></a></div><div class="card"> <a href="/posts/2019-12-25/publish-hexo-blog-via-github-actions/"><div class="card-body"> <em class="small" data-ts="1577203200" data-df="DD/MM/YYYY" > 25/12/2019 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>通过 Github Actions 自动发布 Hexo 博客</h3><div class="text-muted small"><p> Github 今年推出了自己的 CI 集成方案 Github Actions，本着玩一玩不吃亏的态度，我把原来通过 Travis CI 的自动发布流程迁移到了 Github Actions，整个过程还是非常愉快顺利的。 创建博客 这部我就不展开说了，直接到 Hexo 官网参考文档就可以快速开始。 我假设你已经有这么一个博客了，而且也成功手动发布过。 生成密钥 为了安全起见，我们...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/2018-05-18/automation-tests-with-selenium-and-headless/" class="btn btn-outline-primary" prompt=""><p>使用浏览器的HEADLESS模式进行自动化测试</p></a> <a href="/posts/2018-07-01/parse-xmind-to-programmable-data-type/" class="btn btn-outline-primary" prompt=""><p>将xmind文件转成可编程数据类型</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "tobyqin/tobyqin.github.io", "data-repo-id": "R_kgDOHs0WtQ", "data-category": "Comments", "data-category-id": "DIC_kwDOHs0Wtc4CQYoq", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading"></div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/tips/">tips</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/book/">book</a> <a class="post-tag" href="/tags/shell/">shell</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/life/">Life</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/flask/">flask</a> <a class="post-tag" href="/tags/python/">Python</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/tobyqin">Toby Qin</a>.</p></div><div class="footer-right"><p class="mb-0">Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/cn.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-QDMM6HFTDF"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QDMM6HFTDF'); }); </script>
